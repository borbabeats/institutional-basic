---
import "../../styles/global.scss";
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import styles from './style.module.scss';

export const prerender = true;

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout>
  <main class={styles.blogPost}>
    <div class={styles.container}>
      <article>
        <header>
          <h1>{post.data.title}</h1>
          <div class={styles.meta}>
            <time datetime={post.data.pubDate.toISOString()}>
              {post.data.pubDate.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
              })}
            </time>
            {post.data.author && <span>por {post.data.author}</span>}
          </div>
          {post.data.image && (
            <img 
              src={post.data.image} 
              alt={post.data.title}
              class={styles.featuredImage}
              loading="lazy"
            />
          )}
        </header>
        
        <div class={styles.content}>
          <Content />
        </div>
        
        <footer>
          <a href="/blog" class={styles.backLink}>‚Üê Voltar para o blog</a>
        </footer>
      </article>
    </div>
  </main>
</Layout>
