---
import "../styles/global.scss";
import styles from './blog.module.scss';
import Layout from '../layouts/Layout.astro';
import { apiClient } from '../api/api';
import GridPost from '../components/GridPost/GridPost.astro';
let posts = [];
try {

  const response = await apiClient.get(`/api/posts?status=published&page=1&limit=10`);
  posts = Array.isArray(response?.data?.data) ? response.data.data : [];

} catch (error: unknown) {
  console.error('Erro detalhado:', {
    message: error instanceof Error ? error.message : 'Unknown error',
    response: error && typeof error === 'object' && 'response' in error 
      ? (error as any).response?.data 
      : undefined,
    status: error && typeof error === 'object' && 'response' in error
      ? (error as any).response?.status
      : undefined
  });
  posts = [];
}
---
<Layout>
  <main class={styles.section_blog}>
    <div class={styles.section_blog__container}>
      <div class={styles.section_blog__header}>
        <span class={styles.section_blog__subtitle}>Blog</span>
        <h1 class={styles.section_blog__title}>Acompanhe nossas atualizações</h1>
      </div>
      <nav>
        <ul class={styles.section_blog__nav}>
          <li class={styles.section_blog__navItem}><a href={`/blog`}>Todas as categorias</a></li>
          <li class={styles.section_blog__navItem}><a href={`/category_slug/criminal`}>Criminal</a></li>
          <li class={styles.section_blog__navItem}><a href={`/category_slug/trabalhista`}>Trabalhista</a></li>
          <li class={styles.section_blog__navItem}><a href={`/category_slug/familiar`}>Familiar</a></li>
        </ul>
      </nav>
    <GridPost posts={posts} />
    </div>
  </main>
</Layout>